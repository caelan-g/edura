{% extends "layouts/layout_user.html" %} {% block body %}
<!---->
{% if class_data %}
<div class="flex flex-row justify-between my-4">
  <div class="text-4xl font-bold">{{class_entity[1]}}</div>
  <div class="flex flex-row gap-2">
    <div class="flex flex-row gap-2">
      <div class="text-md font-bold bg-gray-200 p-2 rounded-md">
        {{join_code}}
      </div>
      <a
        href="{{ url_for('view_class', class_id=class_entity[0])}}"
        class="font-bold bg-gray-800 p-2 rounded-md text-white cursor-pointer"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2.5"
          stroke="currentColor"
          class="size-5 relative top-[.1rem]"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"
          />
        </svg>
      </a>
    </div>
    <div
      class="text-md text-white bg-gray-800 rounded-md p-2 font-bold flex flex-row cursor-pointer"
      onclick="invitePopup()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="2.5"
        stroke="currentColor"
        class="size-5 relative top-[.1rem] mr-1"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12 4.5v15m7.5-7.5h-15"
        />
      </svg>
      Invite
    </div>
  </div>
</div>
<div class="flex flex-row gap-2">
  <div class="flex flex-col gap-2">
    <div class="text-4xl font-bold">Graphs</div>
    <div class="text-md font-bold bg-gray-100 rounded-md p-4 shadow-md">
      Average study time is {{average_study_time}} seconds
    </div>
    <div class="text-4xl font-bold">Role</div>
    <table
      class="table-fixed text-left text-lg lg:text-base shadow-md rounded-md"
    >
      <thead>
        <tr class="bg-gray-300">
          <th class="p-2 rounded-tl-md w-2 lg:w-12">ID</th>
          <th class="p-2 lg:w-96 w-1/2">Student Name</th>
          <th class="p-2 lg:w-96 w-1/2">Study Time</th>
          <th class="p-2 lg:grow lg:w-auto w-10 rounded-tr-md">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for row in class_data %}
        <tr class="bg-gray-100">
          <td class="p-2 {% if loop.last %} rounded-bl-md{% endif %}">
            {{row[0]}}
          </td>
          <td class="p-2">{{row[1]}}</td>
          <td class="p-2">{{row[2]}}</td>
          <td
            class="p-2 {% if loop.last %} rounded-br-md {% endif %} overflow-hidden"
          >
            <div class="flex flex-row justify-between">
              <div class="flex flex-row gap-1">
                <form action="" method="">
                  <input type="hidden" name="edit" value="{{row[0]}}" />
                  <button class="">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      class="size-6 lg:size-5"
                    >
                      <path
                        d="m5.433 13.917 1.262-3.155A4 4 0 0 1 7.58 9.42l6.92-6.918a2.121 2.121 0 0 1 3 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 0 1-.65-.65Z"
                      />
                      <path
                        d="M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0 0 10 3H4.75A2.75 2.75 0 0 0 2 5.75v9.5A2.75 2.75 0 0 0 4.75 18h9.5A2.75 2.75 0 0 0 17 15.25V10a.75.75 0 0 0-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5Z"
                      />
                    </svg>
                  </button>
                </form>

                <form action="" method="">
                  <input type="hidden" name="delete" value="{{row[0]}}" />
                  <button class="">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      class="size-6 lg:size-5"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </button>
                </form>
              </div>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="flex flex-col gap-2 w-72">
    <div class="text-4xl font-bold">Study Sessions</div>
    {% for session in session_data %}
    <div class="bg-gray-100 rounded-md p-4 flex flex-col shadow-md">
      <div class="text-2xl font-bold">Student: {{session[2]}}</div>
      <div class="text-md">{{session[5]}}</div>
      <div class="text-md text-gray-500">{{session[3]}}</div>
    </div>
    {% endfor %}
  </div>
</div>

{% else %}
<div class="w-full h-full flex items-center flex-col my-24">
  <div class="text-4xl font-bold mb-12">Add some students to your class!</div>
  <div class="text-3xl">Your class code is:</div>
  <div class="flex flex-row gap-2">
    <div class="text-4xl font-bold bg-gray-200 p-2 rounded-md">
      {{join_code}}
    </div>
    <a
      href="{{ url_for('view_class', class_id=class_entity[0])}}"
      class="text-4xl font-bold bg-gray-800 p-2 rounded-md text-white cursor-pointer"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="2.5"
        stroke="currentColor"
        class="size-10"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"
        />
      </svg>
    </a>
  </div>
  <div class="text-xl my-4">or</div>
  <div class="text-2xl flex flex-row">
    Add students by
    <div
      class="decoration-solid underline cursor-pointer ml-1"
      onclick="invitePopup()"
    >
      invite
    </div>
  </div>
</div>
{% endif %}
<div
  id="invite_popup"
  class="opacity-0 transition-all fixed inset-0 bg-opacity-50 bg-black w-full h-full pointer-events-none flex justify-center scale-110"
  onclick="invitePopup()"
>
  <div
    class="bg-white w-[30rem] rounded-md p-12 mx-auto my-auto align-middle"
    onclick="event.stopPropagation()"
  >
    <form action="/invite_student" method="post">
      <div class="text-2xl font-bold">Invite a student</div>
      <input
        class="bg-gray-100 p-2 rounded-md w-full my-6"
        autocomplete="off"
        name="student_username"
        placeholder="Student username"
        type="text"
      />
      <input value="{{class_entity[0]}}" name="class_id" type="hidden" />
      <div class="flex flex-row gap-2">
        <div
          class="bg-gray-200 p-2 font-bold rounded-md cursor-pointer w-1/2 text-center"
          onclick="invitePopup()"
        >
          Cancel
        </div>
        <button
          type="submit"
          class="bg-gray-800 p-2 font-bold text-white rounded-md w-1/2 text-center"
        >
          Invite
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  function invitePopup() {
    const popup = document.getElementById("invite_popup");
    if (popup.classList.contains("opacity-0")) {
      popup.classList.add("opacity-100", "scale-100");
      popup.classList.remove("opacity-0", "pointer-events-none", "scale-110");
    } else {
      popup.classList.add("opacity-0", "pointer-events-none", "scale-110");
      popup.classList.remove("opacity-100", "scale-100");
    }
  }
</script>
<!---->
{% endblock %}
