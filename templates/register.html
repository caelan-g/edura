{% extends "layouts/layout_base.html" %} {% block body %}
<img
  src="{{ url_for('static', filename='images/mesh.png') }}"
  class="absolute lg:-top-[22rem] left-0 -z-10 lg:block hidden w-full"
/>
<div class="lg:w-[23rem] mt-8 mb-20 mx-auto text-center">
  <div
    class="rounded-md py-12 px-8 flex gap-6 flex-col lg:border lg:border-gray-100 lg:shadow-md bg-white"
  >
    <div>
      <div class="text-4xl font-bold lg:text-left lg:text-4xl">Register</div>
      <div class="text-md pb-2 lg:text-left lg:text-base text-gray-700">
        Get started and create an account
      </div>
    </div>

    <form
      action="/register"
      method="post"
      class="flex flex-col gap-4 w-full text-md lg:text-base"
      oninput="validatePassword()"
    >
      <div class="flex flex-row gap-2 w-full">
        <label class="rounded-md cursor-pointer grow border">
          <input
            type="radio"
            name="type"
            value="teacher"
            class="hidden peer"
            checked
          />
          <div
            class="w-full rounded-md peer-checked:font-bold p-3 transition-all peer-checked:bg-gray-800 peer-checked:text-white"
          >
            Teacher
          </div>
        </label>
        <label class="rounded-md cursor-pointer grow border">
          <input type="radio" name="type" value="student" class="hidden peer" />
          <div
            class="w-full rounded-md p-3 transition-all peer-checked:bg-gray-800 peer-checked:text-white peer-checked:font-bold"
          >
            Student
          </div>
        </label>
      </div>
      <input
        name="username"
        placeholder="Username"
        type="text"
        class="p-3 rounded-md border"
      />
      <input
        id="password"
        name="password"
        placeholder="Password"
        type="password"
        required
        class="p-3 rounded-md border"
      />
      <input
        id="second_password"
        name="second_password"
        placeholder="Re-enter password"
        type="password"
        required
        class="p-3 rounded-md border"
      />
      <input
        name="name"
        placeholder="Display Name"
        type="text"
        required
        class="p-3 rounded-md border"
      />

      <button
        id="register-btn"
        type="submit"
        class="bg-gray-800 rounded-md p-3 font-bold text-white hover:bg-gray-700 transition-all disabled:bg-gray-400 disabled:cursor-not-allowed"
        disabled
      >
        Register
      </button>
      <div class="text-left text-xs inline text-gray-800">
        <span id="length" class="text-red-400"
          >Passwords must contain at least 8 characters,</span
        >
        <span id="number" class="text-red-400"> 1 number,</span>
        <span id="uppercase" class="text-red-400"> 1 uppercase letter,</span>
        <span id="lowercase" class="text-red-400"> 1 lowercase letter,</span>
        <span id="match" class="text-red-400"> and must match.</span>
      </div>
    </form>

    <div class="text-md lg:text-sm text-gray-500">
      Already have an account? <a href="/login" class="font-bold">Login</a>
    </div>
  </div>
</div>

<script>
  function validatePassword() {
    let password = document.getElementById("password").value;
    let confirmPassword = document.getElementById("second_password").value;
    let registerBtn = document.getElementById("register-btn");

    // Validation Checks
    let lengthValid = password.length >= 8;
    let numberValid = /\d/.test(password);
    let uppercaseValid = /[A-Z]/.test(password);
    let lowercaseValid = /[a-z]/.test(password);
    let matchValid = password === confirmPassword && password.length > 0;

    // Update UI for each check
    document
      .getElementById("length")
      .classList.toggle("text-red-400", !lengthValid);
    document
      .getElementById("number")
      .classList.toggle("text-red-400", !numberValid);
    document
      .getElementById("uppercase")
      .classList.toggle("text-red-400", !uppercaseValid);
    document
      .getElementById("lowercase")
      .classList.toggle("text-red-400", !lowercaseValid);
    document
      .getElementById("match")
      .classList.toggle("text-red-400", !matchValid);

    // Enable/Disable button based on validity
    registerBtn.disabled = !(
      lengthValid &&
      numberValid &&
      uppercaseValid &&
      lowercaseValid &&
      matchValid
    );
  }
</script>

{% endblock %}
